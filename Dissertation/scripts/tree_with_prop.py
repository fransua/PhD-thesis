
from ete_dev import Tree, TreeStyle, faces, NodeStyle
from PyQt4 import QtGui

## retrieve taxid names from NCBI
## original tree directly from Jaime: ((4787:0.12233087094824669772,(4784:0.21551911055700909148,((((((353151:0.05231662181690119318,353152:0.02965365889032286692):1.06300968000214668407,(507601:0.92953647234173619740,(((31271:0.20775477457151964034,(352914:0.11446395795139066576,5823:0.17280459983468612895):0.01426950311426353896):0.20617467214193593850,(36329:0.28746817012811637371,(5851:0.14042965297056220209,5855:0.13485010698091182135):0.20118058403622443575):0.09172840194133093095):0.93831229986765773976,((333668:0.12248605717641522506,5874:0.12453591146139911250):0.58176251991108496320,5865:0.68355715202904399064):0.58924169807898807427):0.17617700306694283885):0.09649159300931611782):0.36777560941708964393,(5888:1.03518955966676995395,5911:0.96454363248689900523):0.67465878802656065183):0.22398443250585572950,(((5786:0.28913134791735156659,352472:0.23374928214775661517):0.85383324396468851525,((192875:0.83313963008285618628,((((((((28377:0.20372741996612866999,(59729:0.08386977063871299543,9031:0.06696469322795381429):0.10759459069575025292):0.03939857445356047955,(9258:0.28722701565841163296,((13616:0.10878653170398890071,9315:0.13356270099557554509):0.04883372310874383587,((9371:0.25368101713509416673,(9785:0.18413309434909763684,9813:0.11404131028526739988):0.05576942651990055705):0.00457121018781889241,(((((30611:0.14385356612462874004,30608:0.23283913737774944441):0.05366896256583689184,(9478:0.23509367407509002001,(((9600:0.10612428847026446344,((9606:0.00813613389643791894,9598:0.04834617626715907723):0.00481602506973648637,9593:0.24286303514536955461):0.00145654916483534732):0.00754994813607169461,9544:0.05773072264956567723):0.00880929496936404266,9483:0.06050387775453619499):0.02055655844142111055):0.00261191755575566550):0.00456260635707902290,(((43179:0.20444910614808969873,(10141:0.07727734668268972096,(10020:0.22183705558631694466,(10090:0.02660349337976585307,10116:0.07509424914049592226):0.04617573142082235377):0.00764000214567837205):0.00880881714407635158):0.00657223798057096197,(9986:0.20287723219460773727,9978:0.14587185566886173849):0.06383554647523571879):0.00230410238274001778,37347:0.23870275965011816810):0.01580496945576664175):0.00917863645446402240,((((59463:0.15910745826128569469,132908:0.12319696633069725233):0.01197368684779130839,(9685:0.25267915660308143400,9615:0.04369765612989518627):0.03326989699355913793):0.00974075217323774022,((30538:0.23332799404082443795,(9823:0.19496616606187661125,(9913:0.07214464786296329035,9739:0.08496250457366527620):0.00381881040440421992):0.03121739396354039284):0.00890949139441161650,9796:0.05890693449045378977):0.00472376446740397932):0.00602604098884934776,(42254:0.33154389057680744290,9365:0.17330072623689668498):0.07867092164130944087):0.01220545819142446198):0.02006001838754742014,(9361:0.14298634142379151868,9358:0.19941902421323470795):0.09748778248701502058):0.00559745237062118321):0.06643856131818441646):0.02017633182745390275):0.03529922716056824866):0.06670820107085072281,8364:0.40048074058028032551):0.05619810073937257788,(7955:0.25356695903600112718,((69293:0.16009352909003438103,(99883:0.17753679676775263596,31033:0.08488376499239694284):0.06950903004690009435):0.02698195587269291290,8090:0.16366600540954695520):0.06578311883142190508):0.12035556532714110356):0.23729907347707834830,(51511:0.21151849824796103983,7719:0.22702152682347914725):0.48404259621000633729):0.08666101459164954335,((6238:0.28765142103131635665,6239:0.09886210540197026830):0.93945752235201851477,(6669:0.47449491173135044386,(((7070:0.45864088291390819885,(7091:0.53339279960805219272,((180454:0.26431915487356028027,(7175:0.20341808140502509739,7159:0.16377592987793937462):0.08421548687619895279):0.14382138587540382879,((7260:0.11893151356154074705,((7217:0.09820999906674289515,((7245:0.03618127694319728249,7220:0.03444380257674367618):0.01043533298538513489,(7227:0.02743858983193855905,(7238:0.01909083081530500367,7240:0.12910576442897039873):0.01425946816094601256):0.01601335463562589267):0.07778072109741615558):0.03124186908329866161,(7234:0.05453645490036369142,46245:0.00802841260499188164):0.10819878823054068784):0.03029555392305111408):0.05857787597440143601,(7222:0.09502189417399084514,(7244:0.08118572815634232664,7230:0.10164511765673642230):0.02761268907643833759):0.04092339855743002547):0.31138943984084371808):0.16005684257971505846):0.03531488051344106038):0.04332656325469717157,7425:0.49301907629982472114):0.05466423165024979908,(7029:0.58782520898716295044,121225:0.46946662495975577389):0.07274386875525717944):0.11395520530544149540):0.11638645558822378889):0.06436566764136356089):0.05719892685077721667,45351:0.60238939337462760193):0.16265763426089271948,81824:1.08534530247603622222):0.07645546133990495374):0.11752126116511095455,((((284813:0.82610903951932312950,578460:1.06119258260822935114):0.25307313992883306852,481877:1.89302410316425140380):0.26054638158926868297,278021:1.20500958036457572753):1.25355254467194177082,(((109760:0.46189017850727592807,109871:0.54445308601185915531):0.24686273400460997940,(4837:0.30415854921814611256,(36080:0.20351617734257360093,64495:0.27928680774555325605):0.11581975478940832736):0.34499994057446714546):0.08202051479235539233,((((((325569:0.10260145754297948784,332648:0.08827704303426159305):0.26984344311272645545,(((498257:0.03930238306521185304,27335:0.16325788548021991087):0.27271253358531155619,((63577:0.08114270691152951354,(51453:0.09773531015461076055,29875:0.07250230322295542207):0.03224849009474849842):0.16385138012781877426,(140110:0.11864448567686812497,((5507:0.09645323764597052429,117187:0.06912913028835263041):0.04606168074227225823,5518:0.09541613856816937023):0.05456080343400326882):0.11427037261809172564):0.08072804037983022374):0.05382589859157493190,((((573728:0.12745772293620052928,306901:0.18484804355683537302):0.11029142674761151233,5145:0.21565657347578440217):0.04268384019373264865,(29879:0.03190026493358216059,(40127:0.01638264849511731486,367110:0.02953589055947426767):0.01672677376557685225):0.21093623489101223645):0.11431792216336680856,(5116:0.28630195707612099421,242507:0.29350161184006495763):0.04967191794593906612):0.04098450381519231495):0.10515735147814993244):0.09282586561822842031,(((321614:0.19716979952260199616,((29001:0.16356997919291557664,45151:0.10050971383068775522):0.01323098664819930513,5016:0.10536849665766653827):0.08015223445061922525):0.23494903153190555001,(83344:0.25336834910342476146,54734:0.23634129069701445558):0.23543577912036600663):0.10334773116873491317,(((502780:0.17469904621884882467,(339724:0.14565264438435282512,559297:0.09792700852691278712):0.04074882514946905759):0.12350578080799387570,(((63418:0.08748237946576878366,489714:0.08854791861616648219):0.03975707737733381875,554155:0.07312911858401970056):0.21288034433460725769,(33188:0.14224422508329540027,(246410:0.02020990294612907620,454284:0.01366481557753998835):0.09443104561593093638):0.11063678555722672447):0.03994693085877137895):0.06289463999361066815,(500485:0.25543615376932321537,((((5062:0.01829679764669820893,5059:0.03679770492679615423):0.11410326772364194625,341663:0.14724445237795069641):0.02296006982532817348,(227321:0.26641226790689370718,425011:0.12346918648193191959):0.02634363120001731451):0.02571034923572062397,((451804:0.02777842227789746599,331117:0.02024207463695286771):0.05738637886089530127,344612:0.09189340796916922738):0.05977949520149367785):0.04754711443734507825):0.10550526854208500116):0.14945671967029483529):0.04984106762873628804):0.32127243261977150857,(284591:0.56938569958865281606,(((((284592:0.24000465828962805337,294746:0.32564650052727017737):0.03884372661121363035,((((237561:0.05727456699950638636,573826:0.05010409899521641591):0.10117917769929386795,5482:0.17967398123802194587):0.08809688278838960496,(379508:0.21423916735916892495,5480:0.18891060936822973160):0.09463034735138879661):0.09635660492444769742,322104:0.21725247007434500546):0.06192862601821130797):0.05132516101576523049,36911:0.32197919041340899993):0.19177982070646468205,4922:0.49315155880918376541):0.06834444665768356353,(((((284593:0.28773310432318716101,(4931:0.14147118965254093514,(((559292:0.03311646649621513561,27291:0.05040491853119872384):0.02031808321134322484,114525:0.08566777171126074841):0.01922560795031107161,114524:0.11063521551506109997):0.01356542271521937043):0.17262673427826047412):0.03128157021940273369,27288:0.26880168251516922684):0.03158120242533640071,436907:0.28322602173653976809):0.02942969172729736210,4956:0.28597883897880332915):0.06383090201948794784,(((381046:0.12015234589006569543,4914:0.14889018551489649478):0.16482353508759245431,4934:0.18866724875048190846):0.04366128558244707775,(284590:0.30602487293023494797,284811:0.31526659527870337651):0.04845319637697552417):0.03724826181046110574):0.33074581485897702748):0.18499387266083378023):0.19523519260676391873):0.08695788694179434897,((483514:0.23723532712865888494,284812:0.20213050839134957815):0.17899732224562550642,402676:0.29514106281215030103):0.49043691174341075278):0.13660004338498535348,((76773:0.54403733651885377576,237631:0.43519580654111778006):0.29615840655648928426,((40563:0.53348809738748692588,(203908:0.24200997178989056002,5297:0.33304072083469909993):0.35186061140621555099):0.14485962316194281319,(((13563:0.27293706935675687841,(5306:0.25536046031962289504,104341:0.26776866232448459648):0.08741321580952866876):0.03559203991717693749,(((29883:0.23433408277591313840,5346:0.27398022028012586349):0.06586021830359435614,5322:0.27152891017720953704):0.04530818462450642015,5334:0.35664772507509601152):0.04724873225822225770):0.26908357359371309903,(5217:0.35303921120853498650,214684:0.32502719663563467423):0.38820508480029525256):0.09201118147921850954):0.04915723670160940251):0.20341057710045068463):0.10968853262868460963):0.14332451058971995561):0.09463834149888161740):0.11191179655084683431):0.05826365559943440936,(((184922:2.48105208854254843942,412133:1.84780493922422150987):0.27730138871302256742,(370354:0.08415540911760360787,294381:0.07982770244453619990):1.63274701403264899113):0.21461300279326209206,((((5671:0.04045923736408753996,347515:0.06330525559867050678):0.05894985139128681995,5660:0.17305068598598616347):0.41257367746919870743,(5693:0.28550474611647846945,5691:0.40272408677417265155):0.21975092420906242041):1.15667635110690003586,5762:1.09379110527443246248):0.15714685499371200406):0.10903866621727653641):0.03765423734802293698):0.09449780633798503249,((3055:0.80899219245764364405,((436017:0.00729160322033004134,242159:0.00900684816217578975):0.18199895913556154992,70448:0.26846852621142880402):0.73302340023601353369):0.14291178277655966489,((((3847:0.30811722856112616631,(29760:0.80458054076574636593,73824:0.25054471139150402692):0.01102821631766681687):0.05158680163668467877,(3702:0.08984630639309079680,59689:0.09954067019795517779):0.23467695404570157458):0.08215325541112329655,((15368:0.20384146802148653266,39947:0.29529140835681894073):0.02304440381312906558,(4577:0.20431830613523960238,4558:0.09183467802627048870):0.08811204810250418407):0.20371234974698945730):0.18338109345321765287,(88036:0.39960320641657148810,3218:0.38535464480080344751):0.10388592715370167929):0.28704231307695265984):0.25670438845444576437):0.29618540096534368145,(44056:1.04633626345552732673,(296543:0.47239624535841695518,(186039:0.52609563594037678236,556484:0.36727513306941095284):0.15269036952361988990):0.45766212118840976508):0.20836856604031819828):0.66573855059093811626):0.05506949914984231309):0.02035380196008788195,67593:0.10122643955091549517,164328:0.12710275903422380006):0.0;
##
## tree = Tree('((4787:0.12233087094824669772,(4784:0.21551911055700909148,((((((353151:0.05231662181690119318,353152:0.02965365889032286692):1.06300968000214668407,(507601:0.92953647234173619740,(((31271:0.20775477457151964034,(352914:0.11446395795139066576,5823:0.17280459983468612895):0.01426950311426353896):0.20617467214193593850,(36329:0.28746817012811637371,(5851:0.14042965297056220209,5855:0.13485010698091182135):0.20118058403622443575):0.09172840194133093095):0.93831229986765773976,((333668:0.12248605717641522506,5874:0.12453591146139911250):0.58176251991108496320,5865:0.68355715202904399064):0.58924169807898807427):0.17617700306694283885):0.09649159300931611782):0.36777560941708964393,(5888:1.03518955966676995395,5911:0.96454363248689900523):0.67465878802656065183):0.22398443250585572950,(((5786:0.28913134791735156659,352472:0.23374928214775661517):0.85383324396468851525,((192875:0.83313963008285618628,((((((((28377:0.20372741996612866999,(59729:0.08386977063871299543,9031:0.06696469322795381429):0.10759459069575025292):0.03939857445356047955,(9258:0.28722701565841163296,((13616:0.10878653170398890071,9315:0.13356270099557554509):0.04883372310874383587,((9371:0.25368101713509416673,(9785:0.18413309434909763684,9813:0.11404131028526739988):0.05576942651990055705):0.00457121018781889241,(((((30611:0.14385356612462874004,30608:0.23283913737774944441):0.05366896256583689184,(9478:0.23509367407509002001,(((9600:0.10612428847026446344,((9606:0.00813613389643791894,9598:0.04834617626715907723):0.00481602506973648637,9593:0.24286303514536955461):0.00145654916483534732):0.00754994813607169461,9544:0.05773072264956567723):0.00880929496936404266,9483:0.06050387775453619499):0.02055655844142111055):0.00261191755575566550):0.00456260635707902290,(((43179:0.20444910614808969873,(10141:0.07727734668268972096,(10020:0.22183705558631694466,(10090:0.02660349337976585307,10116:0.07509424914049592226):0.04617573142082235377):0.00764000214567837205):0.00880881714407635158):0.00657223798057096197,(9986:0.20287723219460773727,9978:0.14587185566886173849):0.06383554647523571879):0.00230410238274001778,37347:0.23870275965011816810):0.01580496945576664175):0.00917863645446402240,((((59463:0.15910745826128569469,132908:0.12319696633069725233):0.01197368684779130839,(9685:0.25267915660308143400,9615:0.04369765612989518627):0.03326989699355913793):0.00974075217323774022,((30538:0.23332799404082443795,(9823:0.19496616606187661125,(9913:0.07214464786296329035,9739:0.08496250457366527620):0.00381881040440421992):0.03121739396354039284):0.00890949139441161650,9796:0.05890693449045378977):0.00472376446740397932):0.00602604098884934776,(42254:0.33154389057680744290,9365:0.17330072623689668498):0.07867092164130944087):0.01220545819142446198):0.02006001838754742014,(9361:0.14298634142379151868,9358:0.19941902421323470795):0.09748778248701502058):0.00559745237062118321):0.06643856131818441646):0.02017633182745390275):0.03529922716056824866):0.06670820107085072281,8364:0.40048074058028032551):0.05619810073937257788,(7955:0.25356695903600112718,((69293:0.16009352909003438103,(99883:0.17753679676775263596,31033:0.08488376499239694284):0.06950903004690009435):0.02698195587269291290,8090:0.16366600540954695520):0.06578311883142190508):0.12035556532714110356):0.23729907347707834830,(51511:0.21151849824796103983,7719:0.22702152682347914725):0.48404259621000633729):0.08666101459164954335,((6238:0.28765142103131635665,6239:0.09886210540197026830):0.93945752235201851477,(6669:0.47449491173135044386,(((7070:0.45864088291390819885,(7091:0.53339279960805219272,((180454:0.26431915487356028027,(7175:0.20341808140502509739,7159:0.16377592987793937462):0.08421548687619895279):0.14382138587540382879,((7260:0.11893151356154074705,((7217:0.09820999906674289515,((7245:0.03618127694319728249,7220:0.03444380257674367618):0.01043533298538513489,(7227:0.02743858983193855905,(7238:0.01909083081530500367,7240:0.12910576442897039873):0.01425946816094601256):0.01601335463562589267):0.07778072109741615558):0.03124186908329866161,(7234:0.05453645490036369142,46245:0.00802841260499188164):0.10819878823054068784):0.03029555392305111408):0.05857787597440143601,(7222:0.09502189417399084514,(7244:0.08118572815634232664,7230:0.10164511765673642230):0.02761268907643833759):0.04092339855743002547):0.31138943984084371808):0.16005684257971505846):0.03531488051344106038):0.04332656325469717157,7425:0.49301907629982472114):0.05466423165024979908,(7029:0.58782520898716295044,121225:0.46946662495975577389):0.07274386875525717944):0.11395520530544149540):0.11638645558822378889):0.06436566764136356089):0.05719892685077721667,45351:0.60238939337462760193):0.16265763426089271948,81824:1.08534530247603622222):0.07645546133990495374):0.11752126116511095455,((((284813:0.82610903951932312950,578460:1.06119258260822935114):0.25307313992883306852,481877:1.89302410316425140380):0.26054638158926868297,278021:1.20500958036457572753):1.25355254467194177082,(((109760:0.46189017850727592807,109871:0.54445308601185915531):0.24686273400460997940,(4837:0.30415854921814611256,(36080:0.20351617734257360093,64495:0.27928680774555325605):0.11581975478940832736):0.34499994057446714546):0.08202051479235539233,((((((665079:0.10260145754297948784,332648:0.08827704303426159305):0.26984344311272645545,(((498257:0.03930238306521185304,27335:0.16325788548021991087):0.27271253358531155619,((63577:0.08114270691152951354,(51453:0.09773531015461076055,29875:0.07250230322295542207):0.03224849009474849842):0.16385138012781877426,(140110:0.11864448567686812497,((5507:0.09645323764597052429,117187:0.06912913028835263041):0.04606168074227225823,5518:0.09541613856816937023):0.05456080343400326882):0.11427037261809172564):0.08072804037983022374):0.05382589859157493190,((((78579:0.12745772293620052928,306901:0.18484804355683537302):0.11029142674761151233,5145:0.21565657347578440217):0.04268384019373264865,(29879:0.03190026493358216059,(40127:0.01638264849511731486,367110:0.02953589055947426767):0.01672677376557685225):0.21093623489101223645):0.11431792216336680856,(5116:0.28630195707612099421,242507:0.29350161184006495763):0.04967191794593906612):0.04098450381519231495):0.10515735147814993244):0.09282586561822842031,(((321614:0.19716979952260199616,((29001:0.16356997919291557664,45151:0.10050971383068775522):0.01323098664819930513,5016:0.10536849665766653827):0.08015223445061922525):0.23494903153190555001,(83344:0.25336834910342476146,1047171:0.23634129069701445558):0.23543577912036600663):0.10334773116873491317,(((502780:0.17469904621884882467,(339724:0.14565264438435282512,559297:0.09792700852691278712):0.04074882514946905759):0.12350578080799387570,(((63418:0.08748237946576878366,489714:0.08854791861616648219):0.03975707737733381875,554155:0.07312911858401970056):0.21288034433460725769,(33188:0.14224422508329540027,(246410:0.02020990294612907620,454284:0.01366481557753998835):0.09443104561593093638):0.11063678555722672447):0.03994693085877137895):0.06289463999361066815,(500485:0.25543615376932321537,((((5062:0.01829679764669820893,5059:0.03679770492679615423):0.11410326772364194625,341663:0.14724445237795069641):0.02296006982532817348,(227321:0.26641226790689370718,425011:0.12346918648193191959):0.02634363120001731451):0.02571034923572062397,((451804:0.02777842227789746599,331117:0.02024207463695286771):0.05738637886089530127,344612:0.09189340796916922738):0.05977949520149367785):0.04754711443734507825):0.10550526854208500116):0.14945671967029483529):0.04984106762873628804):0.32127243261977150857,(284591:0.56938569958865281606,(((((284592:0.24000465828962805337,294746:0.32564650052727017737):0.03884372661121363035,((((237561:0.05727456699950638636,573826:0.05010409899521641591):0.10117917769929386795,5482:0.17967398123802194587):0.08809688278838960496,(379508:0.21423916735916892495,5480:0.18891060936822973160):0.09463034735138879661):0.09635660492444769742,322104:0.21725247007434500546):0.06192862601821130797):0.05132516101576523049,36911:0.32197919041340899993):0.19177982070646468205,4922:0.49315155880918376541):0.06834444665768356353,(((((284593:0.28773310432318716101,(4931:0.14147118965254093514,(((559292:0.03311646649621513561,27291:0.05040491853119872384):0.02031808321134322484,114525:0.08566777171126074841):0.01922560795031107161,114524:0.11063521551506109997):0.01356542271521937043):0.17262673427826047412):0.03128157021940273369,27288:0.26880168251516922684):0.03158120242533640071,436907:0.28322602173653976809):0.02942969172729736210,4956:0.28597883897880332915):0.06383090201948794784,(((381046:0.12015234589006569543,4914:0.14889018551489649478):0.16482353508759245431,4934:0.18866724875048190846):0.04366128558244707775,(284590:0.30602487293023494797,284811:0.31526659527870337651):0.04845319637697552417):0.03724826181046110574):0.33074581485897702748):0.18499387266083378023):0.19523519260676391873):0.08695788694179434897,((483514:0.23723532712865888494,284812:0.20213050839134957815):0.17899732224562550642,402676:0.29514106281215030103):0.49043691174341075278):0.13660004338498535348,((76773:0.54403733651885377576,237631:0.43519580654111778006):0.29615840655648928426,((40563:0.53348809738748692588,(203908:0.24200997178989056002,5297:0.33304072083469909993):0.35186061140621555099):0.14485962316194281319,(((13563:0.27293706935675687841,(5306:0.25536046031962289504,104341:0.26776866232448459648):0.08741321580952866876):0.03559203991717693749,(((29883:0.23433408277591313840,5346:0.27398022028012586349):0.06586021830359435614,5322:0.27152891017720953704):0.04530818462450642015,5334:0.35664772507509601152):0.04724873225822225770):0.26908357359371309903,(5217:0.35303921120853498650,214684:0.32502719663563467423):0.38820508480029525256):0.09201118147921850954):0.04915723670160940251):0.20341057710045068463):0.10968853262868460963):0.14332451058971995561):0.09463834149888161740):0.11191179655084683431):0.05826365559943440936,(((184922:2.48105208854254843942,412133:1.84780493922422150987):0.27730138871302256742,(370354:0.08415540911760360787,294381:0.07982770244453619990):1.63274701403264899113):0.21461300279326209206,((((5671:0.04045923736408753996,347515:0.06330525559867050678):0.05894985139128681995,5660:0.17305068598598616347):0.41257367746919870743,(5693:0.28550474611647846945,5691:0.40272408677417265155):0.21975092420906242041):1.15667635110690003586,5762:1.09379110527443246248):0.15714685499371200406):0.10903866621727653641):0.03765423734802293698):0.09449780633798503249,((3055:0.80899219245764364405,((436017:0.00729160322033004134,242159:0.00900684816217578975):0.18199895913556154992,70448:0.26846852621142880402):0.73302340023601353369):0.14291178277655966489,((((3847:0.30811722856112616631,(29760:0.80458054076574636593,73824:0.25054471139150402692):0.01102821631766681687):0.05158680163668467877,(3702:0.08984630639309079680,59689:0.09954067019795517779):0.23467695404570157458):0.08215325541112329655,((15368:0.20384146802148653266,39947:0.29529140835681894073):0.02304440381312906558,(4577:0.20431830613523960238,4558:0.09183467802627048870):0.08811204810250418407):0.20371234974698945730):0.18338109345321765287,(88036:0.39960320641657148810,3218:0.38535464480080344751):0.10388592715370167929):0.28704231307695265984):0.25670438845444576437):0.29618540096534368145,(44056:1.04633626345552732673,(296543:0.47239624535841695518,(186039:0.52609563594037678236,556484:0.36727513306941095284):0.15269036952361988990):0.45766212118840976508):0.20836856604031819828):0.66573855059093811626):0.05506949914984231309):0.02035380196008788195,67593:0.10122643955091549517,164328:0.12710275903422380006):0.0;', format=1)
## for tax in tree.iter_descendants():
##     if not tax.name == 'NoName':
##         thing = urllib.urlopen('http://www.ncbi.nlm.nih.gov/taxonomy/?term=%s[uid]&format=text&report=taxon'%(tax.name)).read()
##         name = re.findall('.*<pre>([\w -_]*)\n<\/pre>.*', thing)[0]
##         name = re.sub('([A-Z][a-z-.]* [a-z-.]*).*', '\\1', name)
##         tax.name = name
## 
## tree.show(tree_style=ts)
#
#tree = Tree ('(((((((((((((((((((((((((Homo sapiens:0.0067,Pan troglodytes:0.006667):0.00225,Gorilla gorilla:0.008825):0.00968,Pongo abelii:0.018318):0.00717,Nomascus leucogenys:0.025488):0.00717,(Macaca mulatta:0.007853,?Papio hamadryas:0.007637):0.029618):0.021965,Callithrix jacchus:0.066131):0.05759,Tarsius syrichta:0.137823):0.011062,(Microcebus murinus:0.092749,Otolemur garnettii:0.129725):0.035463):0.015494,Tupaia belangeri:0.186203):0.004937,(((((Mus musculus:0.084509,Rattus norvegicus:0.091589):0.197773,Dipodomys ordii:0.211609):0.022992,Cavia porcellus:0.225629):0.01015,Spermophilus tridecemlineatus:0.148468):0.025746,(Oryctolagus cuniculus:0.114227,Ochotona princeps:0.201069):0.101463):0.015313):0.020593,((((Vicugna pacos:0.107275,(Tursiops truncatus:0.064688,(Bos taurus:0.061796,Ovis aries:0.061796):0.061796):0.025153):0.0201675,Sus scrofa:0.079):0.0201675,((Equus caballus:0.109397,(Felis catus:0.098612,(Ailuropoda melanoleuca:0.051229,Canis familiaris:0.051229):0.051229):0.049845):0.006219,(Myotis lucifugus:0.14254,Pteropus vampyrus:0.113399):0.033706):0.004508):0.011671,(Erinaceus europaeus:0.221785,Sorex araneus:0.269562):0.056393):0.021227):0.023664,(((Loxodonta africana:0.082242,Procavia capensis:0.155358):0.02699,Echinops telfairi:0.245936):0.049697,(Dasypus novemcinctus:0.116664,Choloepus hoffmanni:0.096357):0.053145):0.006717):0.234728,(Monodelphis domestica:0.125686,(Macropus eugenii:0.101004,Sarcophilus harrisii:0.101004):0.021004):0.2151):0.071664,Ornithorhynchus anatinus:0.456592):0.109504,((((Gallus gallus:0.041384,Meleagris gallopavo:0.041384):0.041384,Anas platyrhynchos:0.082768):0.082768,Taeniopygia guttata:0.171542):0.199223,Anolis carolinensis:0.489241):0.105143):0.172371,Xenopus tropicalis:0.855573):0.155677,Latimeria chalumnae:0.155677):0.155677,(((Oreochromis niloticus:0.45,(Tetraodon nigroviridis:0.224159,Takifugu rubripes:0.203847):0.195181,(Gasterosteus aculeatus:0.316413,Oryzias latipes:0.48197):0.05915):0.16282,Gadus morhua:0.16282):0.16282,Danio rerio:0.730752):0.147949):0.526688,Petromyzon marinus:0.526688):0.526688,(Ciona savignyi:0.8,Ciona intestinalis:0.8)Cionidae:0.6)Chordata:0.2,(?Apis mellifera:0.9,(((?Aedes aegypti:0.25,?Culex quinquefasciatus:0.25):0.25,Anopheles gambiae:0.5)Culicinae:0.2,Drosophila melanogaster:0.8)Diptera:0.1)Endopterygota:0.7)Coelomata:0.1,Caenorhabditis elegans:1.7)Bilateria:0.3,Saccharomyces cerevisiae:1.9)Fungi Metazoa group:0.3),(((Sorghum bicolor, Zea mays),(Brachypodium distachyon,Oryza sativa)),((Arabidopsis thaliana,Arabidopsis lyrata),Populu trichocarpa)));',format=1)
#tree = Tree ('((Phytophthora infestans:0.122331,(Phytophthora capsici:0.215519,((((((Cryptosporidium hominis:0.0523166,Cryptosporidium parvum:0.0296537)NoName:1.06301,(Toxoplasma gondii:0.929536,(((Plasmodium chabaudi:0.207755,(Plasmodium yoelii:0.114464,Plasmodium berghei:0.172805)NoName:0.0142695)NoName:0.206175,(Plasmodium falciparum:0.287468,(Plasmodium knowlesi:0.14043,Plasmodium vivax:0.13485)NoName:0.201181)NoName:0.0917284)NoName:0.938312,((Theileria parva:0.122486,Theileria annulata:0.124536)NoName:0.581763,Babesia bovis:0.683557)NoName:0.589242)NoName:0.176177)NoName:0.0964916)NoName:0.367776,(Paramecium tetraurelia:1.03519,Tetrahymena thermophila:0.964544)NoName:0.674659)NoName:0.223984,(((Dictyostelium purpureum:0.289131,Dictyostelium discoideum:0.233749)NoName:0.853833,((Capsaspora owczarzaki:0.83314,((((((((Anolis carolinensis:0.203727,(Taeniopygia guttata:0.0838698,Gallus gallus:0.0669647)NoName:0.107595)NoName:0.0393986,(Ornithorhynchus anatinus:0.287227,((Monodelphis domestica:0.108787,Macropus eugenii:0.133563)NoName:0.0488337,((Echinops telfairi:0.253681,(Loxodonta africana:0.184133,Procavia capensis:0.114041)NoName:0.0557694)NoName:0.00457121,(((((Otolemur garnettii:0.143854,Microcebus murinus:0.232839)NoName:0.053669,(Tarsius syrichta:0.235094,(((Pongo pygmaeus:0.106124,((Homo sapiens:0.00813613,Pan troglodytes:0.0483462)NoName:0.00481603,Gorilla gorilla:0.242863)NoName:0.00145655)NoName:0.00754995,Macaca mulatta:0.0577307)NoName:0.00880929,Callithrix jacchus:0.0605039)NoName:0.0205566)NoName:0.00261192)NoName:0.00456261,(((Ictidomys tridecemlineatus:0.204449,(Cavia porcellus:0.0772773,(Dipodomys ordii:0.221837,(Mus musculus:0.0266035,Rattus norvegicus:0.0750942)NoName:0.0461757)NoName:0.00764)NoName:0.00880882)NoName:0.00657224,(Oryctolagus cuniculus:0.202877,Ochotona princeps:0.145872)NoName:0.0638355)NoName:0.0023041,Tupaia belangeri:0.238703)NoName:0.015805)NoName:0.00917864,((((Myotis lucifugus:0.159107,Pteropus vampyrus:0.123197)NoName:0.0119737,(Felis catus:0.252679,Canis lupus:0.0436977)NoName:0.0332699)NoName:0.00974075,((Vicugna pacos:0.233328,(Sus scrofa:0.194966,(Bos taurus:0.0721446,Tursiops truncatus:0.0849625)NoName:0.00381881)NoName:0.0312174)NoName:0.00890949,Equus caballus:0.0589069)NoName:0.00472376)NoName:0.00602604,(Sorex araneus:0.331544,Erinaceus europaeus:0.173301)NoName:0.0786709)NoName:0.0122055)NoName:0.02006,(Dasypus novemcinctus:0.142986,Choloepus hoffmanni:0.199419)NoName:0.0974878)NoName:0.00559745)NoName:0.0664386)NoName:0.0201763)NoName:0.0352992)NoName:0.0667082,Xenopus :0.400481)NoName:0.0561981,(Danio rerio:0.253567,((Gasterosteus aculeatus:0.160094,(Tetraodon nigroviridis:0.177537,Takifugu rubripes:0.0848838)NoName:0.069509)NoName:0.026982,Oryzias latipes:0.163666)NoName:0.0657831)NoName:0.120356)NoName:0.237299,(Ciona savignyi:0.211518,Ciona intestinalis:0.227022)NoName:0.484043)NoName:0.086661,((Caenorhabditis briggsae:0.287651,Caenorhabditis elegans:0.0988621)NoName:0.939458,(Daphnia pulex:0.474495,(((Tribolium castaneum:0.458641,(Bombyx mori:0.533393,((Anopheles gambiae:0.264319,(Culex pipiens:0.203418,Aedes aegypti:0.163776)NoName:0.0842155)NoName:0.143821,((Drosophila willistoni:0.118932,((Drosophila ananassae:0.09821,((Drosophila yakuba:0.0361813,Drosophila erecta:0.0344438)NoName:0.0104353,(Drosophila melanogaster:0.0274386,(Drosophila sechellia:0.0190908,Drosophila simulans:0.129106)NoName:0.0142595)NoName:0.0160134)NoName:0.0777807)NoName:0.0312419,(Drosophila persimilis:0.0545365,Drosophila pseudoobscura:0.00802841)NoName:0.108199)NoName:0.0302956)NoName:0.0585779,(Drosophila grimshawi:0.0950219,(Drosophila virilis:0.0811857,Drosophila mojavensis:0.101645)NoName:0.0276127)NoName:0.0409234)NoName:0.311389)NoName:0.160057)NoName:0.0353149)NoName:0.0433266,Nasonia vitripennis:0.493019)NoName:0.0546642,(Acyrthosiphon pisum:0.587825,Pediculus humanus:0.469467)NoName:0.0727439)NoName:0.113955)NoName:0.116386)NoName:0.0643657)NoName:0.0571989,Nematostella vectensis:0.602389)NoName:0.162658,Monosiga brevicollis:1.08535)NoName:0.0764555)NoName:0.117521,((((Encephalitozoon cuniculi:0.826109,Nosema ceranae:1.06119)NoName:0.253073,Enterocytozoon bieneusi:1.89302)NoName:0.260546,Antonospora locustae:1.20501)NoName:1.25355,(((Spizellomyces punctatus:0.46189,Batrachochytrium dendrobatidis:0.544453)NoName:0.246863,(Phycomyces blakesleeanus:0.304159,(Mucor circinelloides:0.203516,Rhizopus oryzae:0.279287)NoName:0.11582)NoName:0.345)NoName:0.0820205,((((((Sclerotinia sclerotiorum:0.102601,Botryotinia fuckeliana:0.088277)NoName:0.269843,(((Verticillium dahliae:0.0393024,Verticillium albo-atrum:0.163258)NoName:0.272713,((Trichoderma atroviride:0.0811427,(Hypocrea jecorina:0.0977353,Hypocrea virens:0.0725023)NoName:0.0322485)NoName:0.163851,(Nectria haematococca:0.118644,((Fusarium oxysporum:0.0964532,Gibberella moniliformis:0.0691291)NoName:0.0460617,Gibberella zeae:0.0954161)NoName:0.0545608)NoName:0.11427)NoName:0.080728)NoName:0.0538259,((((Myceliophthora thermophila:0.127458,Chaetomium globosum:0.184848)NoName:0.110291,Podospora anserina:0.215657)NoName:0.0426838,(Neurospora discreta:0.0319003,(Neurospora tetrasperma:0.0163826,Neurospora crassa:0.0295359)NoName:0.0167268)NoName:0.210936)NoName:0.114318,(Cryphonectria parasitica:0.286302,Magnaporthe oryzae:0.293502)NoName:0.0496719)NoName:0.0409845)NoName:0.105157)NoName:0.0928259,(((Phaeosphaeria nodorum:0.19717,((Alternaria brassicicola:0.16357,Pyrenophora tritici-repentis:0.10051)NoName:0.013231,Cochliobolus heterostrophus:0.105368)NoName:0.0801522)NoName:0.234949,(Mycosphaerella fijiensis:0.253368,Zymoseptoria tritici:0.236341)NoName:0.235436)NoName:0.103348,(((Paracoccidioides brasiliensis:0.174699,(Ajellomyces capsulatus:0.145653,Ajellomyces dermatitidis:0.097927)NoName:0.0407488)NoName:0.123506,(((Trichophyton equinum:0.0874824,Microsporum gypseum:0.0885479)NoName:0.0397571,Arthroderma otae:0.0731291)NoName:0.21288,(Uncinocarpus reesii:0.142244,(Coccidioides immitis:0.0202099,Coccidioides posadasii:0.0136648)NoName:0.094431)NoName:0.110637)NoName:0.0399469)NoName:0.0628946,(Penicillium chrysogenum:0.255436,((((Aspergillus oryzae:0.0182968,Aspergillus flavus:0.0367977)NoName:0.114103,Aspergillus terreus:0.147244)NoName:0.0229601,(Aspergillus nidulans:0.266412,Aspergillus niger:0.123469)NoName:0.0263436)NoName:0.0257103,((Aspergillus fumigatus:0.0277784,Neosartorya fischeri:0.0202421)NoName:0.0573864,Aspergillus clavatus:0.0918934)NoName:0.0597795)NoName:0.0475471)NoName:0.105505)NoName:0.149457)NoName:0.0498411)NoName:0.321272,(Yarrowia lipolytica:0.569386,(((((Debaryomyces hansenii:0.240005,Meyerozyma guilliermondii:0.325647)NoName:0.0388437,((((Candida albicans:0.0572746,Candida dubliniensis:0.0501041)NoName:0.101179,Candida tropicalis:0.179674)NoName:0.0880969,(Lodderomyces elongisporus:0.214239,Candida parapsilosis:0.188911)NoName:0.0946303)NoName:0.0963566,Scheffersomyces stipitis:0.217252)NoName:0.0619286)NoName:0.0513252,Clavispora lusitaniae:0.321979)NoName:0.19178,Komagataella pastoris:0.493152)NoName:0.0683444,(((((Candida glabrata:0.287733,(Saccharomyces bayanus:0.141471,(((Saccharomyces cerevisiae:0.0331165,Saccharomyces paradoxus:0.0504049)NoName:0.0203181,Saccharomyces mikatae:0.0856678)NoName:0.0192256,Saccharomyces kudriavzevii:0.110635)NoName:0.0135654)NoName:0.172627)NoName:0.0312816,Naumovozyma castellii:0.268802)NoName:0.0315812,Vanderwaltozyma polyspora:0.283226)NoName:0.0294297,Zygosaccharomyces rouxii:0.285979)NoName:0.0638309,(((Lachancea thermotolerans:0.120152,Lachancea waltii:0.14889)NoName:0.164824,Lachancea kluyveri:0.188667)NoName:0.0436613,(Kluyveromyces lactis:0.306025,Ashbya gossypii:0.315267)NoName:0.0484532)NoName:0.0372483)NoName:0.330746)NoName:0.184994)NoName:0.195235)NoName:0.0869579,((Schizosaccharomyces octosporus:0.237235,Schizosaccharomyces pombe:0.202131)NoName:0.178997,Schizosaccharomyces japonicus:0.295141)NoName:0.490437)NoName:0.1366,((Malassezia globosa:0.544037,Ustilago maydis:0.435196)NoName:0.296158,((Sporobolomyces roseus:0.533488,(Melampsora larici-populina:0.24201,Puccinia graminis:0.333041)NoName:0.351861)NoName:0.14486,(((Heterobasidion annosum:0.272937,(Phanerochaete chrysosporium:0.25536,Postia placenta:0.267769)NoName:0.0874132)NoName:0.035592,(((Laccaria bicolor:0.234334,Coprinopsis cinerea:0.27398)NoName:0.0658602,Pleurotus ostreatus:0.271529)NoName:0.0453082,Schizophyllum commune:0.356648)NoName:0.0472487)NoName:0.269084,(Tremella mesenterica:0.353039,Cryptococcus neoformans:0.325027)NoName:0.388205)NoName:0.0920112)NoName:0.0491572)NoName:0.203411)NoName:0.109689)NoName:0.143325)NoName:0.0946383)NoName:0.111912)NoName:0.0582637,(((Giardia lamblia:2.48105,Trichomonas vaginalis:1.8478)NoName:0.277301,(Entamoeba dispar:0.0841554,Entamoeba histolytica:0.0798277)NoName:1.63275)NoName:0.214613,((((Leishmania infantum:0.0404592,Leishmania major:0.0633053)NoName:0.0589499,Leishmania braziliensis:0.173051)NoName:0.412574,(Trypanosoma cruzi:0.285505,Trypanosoma brucei:0.402724)NoName:0.219751)NoName:1.15668,Naegleria gruberi:1.09379)NoName:0.157147)NoName:0.109039)NoName:0.0376542)NoName:0.0944978,((Chlamydomonas reinhardtii:0.808992,((Ostreococcus lucimarinus:0.0072916,Ostreococcus :0.00900685)NoName:0.181999,Ostreococcus tauri:0.268469)NoName:0.733023)NoName:0.142912,((((Glycine max:0.308117,(Vitis vinifera:0.804581,Populus balsamifera:0.250545)NoName:0.0110282)NoName:0.0515868,(Arabidopsis thaliana:0.0898463,Arabidopsis lyrata:0.0995407)NoName:0.234677)NoName:0.0821533,((Brachypodium distachyon:0.203841,Oryza sativa:0.295291)NoName:0.0230444,(Zea mays:0.204318,Sorghum bicolor:0.0918347)NoName:0.088112)NoName:0.203712)NoName:0.183381,(Selaginella moellendorffii:0.399603,Physcomitrella patens:0.385355)NoName:0.103886)NoName:0.287042)NoName:0.256704)NoName:0.296185,(Aureococcus anophagefferens:1.04634,(Thalassiosira pseudonana:0.472396,(Fragilariopsis cylindrus:0.526096,Phaeodactylum tricornutum:0.367275)NoName:0.15269)NoName:0.457662)NoName:0.208369)NoName:0.665739)NoName:0.0550695)NoName:0.0203538,Phytophthora sojae:0.101226,Phytophthora ramorum:0.127103);')
#tree = Tree ('((Phytophthora infestans:0.122331,(Phytophthora capsici:0.215519,((((((Cryptosporidium hominis:0.0523166,Cryptosporidium parvum:0.0296537)NoName:1.06301,(Toxoplasma gondii:0.929536,(((Plasmodium chabaudi:0.207755,(Plasmodium yoelii:0.114464,Plasmodium berghei:0.172805)NoName:0.0142695)NoName:0.206175,(Plasmodium falciparum:0.287468,(Plasmodium knowlesi:0.14043,Plasmodium vivax:0.13485)NoName:0.201181)NoName:0.0917284)NoName:0.938312,((Theileria parva:0.122486,Theileria annulata:0.124536)NoName:0.581763,Babesia bovis:0.683557)NoName:0.589242)NoName:0.176177)NoName:0.0964916)NoName:0.367776,(Paramecium tetraurelia:1.03519,Tetrahymena thermophila:0.964544)NoName:0.674659)NoName:0.223984,(((Dictyostelium purpureum:0.289131,Dictyostelium discoideum:0.233749)NoName:0.853833,((Capsaspora owczarzaki:0.83314,((((((((Anolis carolinensis:0.203727,(Taeniopygia guttata:0.0838698,Gallus gallus:0.0669647)NoName:0.107595)NoName:0.0393986,(Ornithorhynchus anatinus:0.287227,((Monodelphis domestica:0.108787,Macropus eugenii:0.133563)NoName:0.0488337,((Echinops telfairi:0.253681,(Loxodonta africana:0.184133,Procavia capensis:0.114041)NoName:0.0557694)NoName:0.00457121,(((((Otolemur garnettii:0.143854,Microcebus murinus:0.232839)NoName:0.053669,(Tarsius syrichta:0.235094,(((Pongo abelii:0.106124,((Homo sapiens:0.00813613,Pan troglodytes:0.0483462)NoName:0.00481603,Gorilla gorilla:0.242863)NoName:0.00145655)NoName:0.00754995,Macaca mulatta:0.0577307)NoName:0.00880929,Callithrix jacchus:0.0605039)NoName:0.0205566)NoName:0.00261192)NoName:0.00456261,(((Ictidomys tridecemlineatus:0.204449,(Cavia porcellus:0.0772773,(Dipodomys ordii:0.221837,(Mus musculus:0.0266035,Rattus norvegicus:0.0750942)NoName:0.0461757)NoName:0.00764)NoName:0.00880882)NoName:0.00657224,(Oryctolagus cuniculus:0.202877,Ochotona princeps:0.145872)NoName:0.0638355)NoName:0.0023041,Tupaia belangeri:0.238703)NoName:0.015805)NoName:0.00917864,((((Myotis lucifugus:0.159107,Pteropus vampyrus:0.123197)NoName:0.0119737,(Felis catus:0.252679,Canis familiaris:0.0436977)NoName:0.0332699)NoName:0.00974075,((Vicugna pacos:0.233328,(Sus scrofa:0.194966,(Bos taurus:0.0721446,Tursiops truncatus:0.0849625)NoName:0.00381881)NoName:0.0312174)NoName:0.00890949,Equus caballus:0.0589069)NoName:0.00472376)NoName:0.00602604,(Sorex araneus:0.331544,Erinaceus europaeus:0.173301)NoName:0.0786709)NoName:0.0122055)NoName:0.02006,(Dasypus novemcinctus:0.142986,Choloepus hoffmanni:0.199419)NoName:0.0974878)NoName:0.00559745)NoName:0.0664386)NoName:0.0201763)NoName:0.0352992)NoName:0.0667082,Xenopus :0.400481)NoName:0.0561981,(Danio rerio:0.253567,((Gasterosteus aculeatus:0.160094,(Tetraodon nigroviridis:0.177537,Takifugu rubripes:0.0848838)NoName:0.069509)NoName:0.026982,Oryzias latipes:0.163666)NoName:0.0657831)NoName:0.120356)NoName:0.237299,(Ciona savignyi:0.211518,Ciona intestinalis:0.227022)NoName:0.484043)NoName:0.086661,((Caenorhabditis briggsae:0.287651,Caenorhabditis elegans:0.0988621)NoName:0.939458,(Daphnia pulex:0.474495,(((Tribolium castaneum:0.458641,(Bombyx mori:0.533393,((Anopheles gambiae:0.264319,(Culex pipiens:0.203418,Aedes aegypti:0.163776)NoName:0.0842155)NoName:0.143821,((Drosophila willistoni:0.118932,((Drosophila ananassae:0.09821,((Drosophila yakuba:0.0361813,Drosophila erecta:0.0344438)NoName:0.0104353,(Drosophila melanogaster:0.0274386,(Drosophila sechellia:0.0190908,Drosophila simulans:0.129106)NoName:0.0142595)NoName:0.0160134)NoName:0.0777807)NoName:0.0312419,(Drosophila persimilis:0.0545365,Drosophila pseudoobscura:0.00802841)NoName:0.108199)NoName:0.0302956)NoName:0.0585779,(Drosophila grimshawi:0.0950219,(Drosophila virilis:0.0811857,Drosophila mojavensis:0.101645)NoName:0.0276127)NoName:0.0409234)NoName:0.311389)NoName:0.160057)NoName:0.0353149)NoName:0.0433266,Nasonia vitripennis:0.493019)NoName:0.0546642,(Acyrthosiphon pisum:0.587825,Pediculus humanus:0.469467)NoName:0.0727439)NoName:0.113955)NoName:0.116386)NoName:0.0643657)NoName:0.0571989,Nematostella vectensis:0.602389)NoName:0.162658,Monosiga brevicollis:1.08535)NoName:0.0764555)NoName:0.117521,((((Encephalitozoon cuniculi:0.826109,Nosema ceranae:1.06119)NoName:0.253073,Enterocytozoon bieneusi:1.89302)NoName:0.260546,Antonospora locustae:1.20501)NoName:1.25355,(((Spizellomyces punctatus:0.46189,Batrachochytrium dendrobatidis:0.544453)NoName:0.246863,(Phycomyces blakesleeanus:0.304159,(Mucor circinelloides:0.203516,Rhizopus oryzae:0.279287)NoName:0.11582)NoName:0.345)NoName:0.0820205,((((((Sclerotinia sclerotiorum:0.102601,Botryotinia fuckeliana:0.088277)NoName:0.269843,(((Verticillium dahliae:0.0393024,Verticillium albo-atrum:0.163258)NoName:0.272713,((Trichoderma atroviride:0.0811427,(Hypocrea jecorina:0.0977353,Hypocrea virens:0.0725023)NoName:0.0322485)NoName:0.163851,(Nectria haematococca:0.118644,((Fusarium oxysporum:0.0964532,Gibberella moniliformis:0.0691291)NoName:0.0460617,Gibberella zeae:0.0954161)NoName:0.0545608)NoName:0.11427)NoName:0.080728)NoName:0.0538259,((((Myceliophthora thermophila:0.127458,Chaetomium globosum:0.184848)NoName:0.110291,Podospora anserina:0.215657)NoName:0.0426838,(Neurospora discreta:0.0319003,(Neurospora tetrasperma:0.0163826,Neurospora crassa:0.0295359)NoName:0.0167268)NoName:0.210936)NoName:0.114318,(Cryphonectria parasitica:0.286302,Magnaporthe oryzae:0.293502)NoName:0.0496719)NoName:0.0409845)NoName:0.105157)NoName:0.0928259,(((Phaeosphaeria nodorum:0.19717,((Alternaria brassicicola:0.16357,Pyrenophora tritici-repentis:0.10051)NoName:0.013231,Cochliobolus heterostrophus:0.105368)NoName:0.0801522)NoName:0.234949,(Mycosphaerella fijiensis:0.253368,Zymoseptoria tritici:0.236341)NoName:0.235436)NoName:0.103348,(((Paracoccidioides brasiliensis:0.174699,(Ajellomyces capsulatus:0.145653,Ajellomyces dermatitidis:0.097927)NoName:0.0407488)NoName:0.123506,(((Trichophyton equinum:0.0874824,Microsporum gypseum:0.0885479)NoName:0.0397571,Arthroderma otae:0.0731291)NoName:0.21288,(Uncinocarpus reesii:0.142244,(Coccidioides immitis:0.0202099,Coccidioides posadasii:0.0136648)NoName:0.094431)NoName:0.110637)NoName:0.0399469)NoName:0.0628946,(Penicillium chrysogenum:0.255436,((((Aspergillus oryzae:0.0182968,Aspergillus flavus:0.0367977)NoName:0.114103,Aspergillus terreus:0.147244)NoName:0.0229601,(Aspergillus nidulans:0.266412,Aspergillus niger:0.123469)NoName:0.0263436)NoName:0.0257103,((Aspergillus fumigatus:0.0277784,Neosartorya fischeri:0.0202421)NoName:0.0573864,Aspergillus clavatus:0.0918934)NoName:0.0597795)NoName:0.0475471)NoName:0.105505)NoName:0.149457)NoName:0.0498411)NoName:0.321272,(Yarrowia lipolytica:0.569386,(((((Debaryomyces hansenii:0.240005,Meyerozyma guilliermondii:0.325647)NoName:0.0388437,((((Candida albicans:0.0572746,Candida dubliniensis:0.0501041)NoName:0.101179,Candida tropicalis:0.179674)NoName:0.0880969,(Lodderomyces elongisporus:0.214239,Candida parapsilosis:0.188911)NoName:0.0946303)NoName:0.0963566,Scheffersomyces stipitis:0.217252)NoName:0.0619286)NoName:0.0513252,Clavispora lusitaniae:0.321979)NoName:0.19178,Komagataella pastoris:0.493152)NoName:0.0683444,(((((Candida glabrata:0.287733,(Saccharomyces bayanus:0.141471,(((Saccharomyces cerevisiae:0.0331165,Saccharomyces paradoxus:0.0504049)NoName:0.0203181,Saccharomyces mikatae:0.0856678)NoName:0.0192256,Saccharomyces kudriavzevii:0.110635)NoName:0.0135654)NoName:0.172627)NoName:0.0312816,Naumovozyma castellii:0.268802)NoName:0.0315812,Vanderwaltozyma polyspora:0.283226)NoName:0.0294297,Zygosaccharomyces rouxii:0.285979)NoName:0.0638309,(((Lachancea thermotolerans:0.120152,Lachancea waltii:0.14889)NoName:0.164824,Lachancea kluyveri:0.188667)NoName:0.0436613,(Kluyveromyces lactis:0.306025,Ashbya gossypii:0.315267)NoName:0.0484532)NoName:0.0372483)NoName:0.330746)NoName:0.184994)NoName:0.195235)NoName:0.0869579,((Schizosaccharomyces octosporus:0.237235,Schizosaccharomyces pombe:0.202131)NoName:0.178997,Schizosaccharomyces japonicus:0.295141)NoName:0.490437)NoName:0.1366,((Malassezia globosa:0.544037,Ustilago maydis:0.435196)NoName:0.296158,((Sporobolomyces roseus:0.533488,(Melampsora larici-populina:0.24201,Puccinia graminis:0.333041)NoName:0.351861)NoName:0.14486,(((Heterobasidion annosum:0.272937,(Phanerochaete chrysosporium:0.25536,Postia placenta:0.267769)NoName:0.0874132)NoName:0.035592,(((Laccaria bicolor:0.234334,Coprinopsis cinerea:0.27398)NoName:0.0658602,Pleurotus ostreatus:0.271529)NoName:0.0453082,Schizophyllum commune:0.356648)NoName:0.0472487)NoName:0.269084,(Tremella mesenterica:0.353039,Cryptococcus neoformans:0.325027)NoName:0.388205)NoName:0.0920112)NoName:0.0491572)NoName:0.203411)NoName:0.109689)NoName:0.143325)NoName:0.0946383)NoName:0.111912)NoName:0.0582637,(((Giardia lamblia:2.48105,Trichomonas vaginalis:1.8478)NoName:0.277301,(Entamoeba dispar:0.0841554,Entamoeba histolytica:0.0798277)NoName:1.63275)NoName:0.214613,((((Leishmania infantum:0.0404592,Leishmania major:0.0633053)NoName:0.0589499,Leishmania braziliensis:0.173051)NoName:0.412574,(Trypanosoma cruzi:0.285505,Trypanosoma brucei:0.402724)NoName:0.219751)NoName:1.15668,Naegleria gruberi:1.09379)NoName:0.157147)NoName:0.109039)NoName:0.0376542)NoName:0.0944978,((Chlamydomonas reinhardtii:0.808992,((Ostreococcus lucimarinus:0.0072916,Ostreococcus :0.00900685)NoName:0.181999,Ostreococcus tauri:0.268469)NoName:0.733023)NoName:0.142912,((((Glycine max:0.308117,(Vitis vinifera:0.804581,Populus trichocarpa:0.250545)NoName:0.0110282)NoName:0.0515868,(Arabidopsis thaliana:0.0898463,Arabidopsis lyrata:0.0995407)NoName:0.234677)NoName:0.0821533,((Brachypodium distachyon:0.203841,Oryza sativa:0.295291)NoName:0.0230444,(Zea mays:0.204318,Sorghum bicolor:0.0918347)NoName:0.088112)NoName:0.203712)NoName:0.183381,(Selaginella moellendorffii:0.399603,Physcomitrella patens:0.385355)NoName:0.103886)NoName:0.287042)NoName:0.256704)NoName:0.296185,(Aureococcus anophagefferens:1.04634,(Thalassiosira pseudonana:0.472396,(Fragilariopsis cylindrus:0.526096,Phaeodactylum tricornutum:0.367275)NoName:0.15269)NoName:0.457662)NoName:0.208369)NoName:0.665739)NoName:0.0550695)NoName:0.0203538,Phytophthora sojae:0.101226,Phytophthora ramorum:0.127103):0;', format=1)
#for spe in tree:
#    if not spe.name in species:
#        spe.delete(prevent_nondicotomic=False)
#
#while len (tree)*2-2 != len (tree.get_descendants()):
#    for node in tree.get_descendants()+[tree]:
#        if node.is_leaf():
#            if node.name == 'NoName':
#                node.delete(prevent_nondicotomic=False)
#            continue
#        if len (node.get_children()) == 1:
#            node.get_children()[0].dist += node.dist
#            if node.is_root():
#                node.get_children()[0].delete(prevent_nondicotomic=False)
#            else:
#                node.delete(prevent_nondicotomic=False)


class Legend(faces.StaticItemFace, faces.Face):
    """
    Draw legend

    :arguments colors: a list of colors
    :arguments names: a list of names that corresponds to colors
    :arguments 11 fsize: font size.
    :arguments 1 columns: number of columns to display
    """
    def __init__(self, colors, names, fsize=11, columns=1):
        super(Legend, self).__init__(QtGui.QGraphicsRectItem())
        self.colors = colors
        self.names  = names
        self.fsize = fsize
        self.columns = columns
        self.item.setPen(QtGui.QPen(QtGui.QColor('black')))

    def update_items(self):
        rectItem = QtGui.QGraphicsRectItem(parent=self.item)
        y_offset = 120
        x = 5
        max_y  = 0
        max_tw = 0
        col_w  = 0
        num = int(float(len(self.colors))/self.columns)
        rest = len(self.colors) % self.columns
        for col in range (self.columns):
            col = int(col*num)
            x += col_w
            col_w = 0
            y = 5
            for name, color in zip(self.names [col:col+int(num)+(1 if rest else 0)],
                                   self.colors[col:col+int(num)+(1 if rest else 0)]):
                subRect = QtGui.QGraphicsRectItem(parent=rectItem)
                subRect.setX(x)
                subRect.setY(y + y_offset)
                subRect.setZValue(2)
                subRect.rect().setWidth (50)
                subRect.rect().setHeight (50)
                text = QtGui.QGraphicsSimpleTextItem(name, parent=subRect)
                text.setFont(QtGui.QFont("Courier", self.fsize))
                text.setZValue(2)
                th = text.boundingRect().height()
                tw = text.boundingRect().width()
                col_w = max (tw, col_w)
                text.setX(th + float(th)/2)
                subsubRect = QtGui.QGraphicsRectItem(0, 0, th, th, parent=subRect)
                subsubRect.setBrush(QtGui.QColor(color))
                subsubRect.setPen(QtGui.QPen(QtGui.QColor('black'), 1))
                y +=  th + float(th)/4
            col_w += float(th)/2 + th + float(th)/2
            max_tw += col_w
            max_y = max(y, max_y)
            rest -= (1 if rest else 0)
        subRect = QtGui.QGraphicsRectItem(0, 0 + y_offset,
                                          max_tw +10 ,
                                          max_y + 5,
                                          parent=rectItem)
        subRect.setPen(QtGui.QPen(QtGui.QColor('black'), 2))
        subRect.setBrush(QtGui.QColor('white'))
        subRect.setZValue(1)
        subRect = QtGui.QGraphicsRectItem(5, 5 + y_offset,
                                          max_tw + +10 ,
                                          max_y + 5,
                                          parent=rectItem)
        subRect.setBrush(QtGui.QColor('gray'))
        subRect.setPen(QtGui.QPen(QtGui.QColor('gray'), 2))
        subRect.setZValue(0)
        
        
def my_basic(node):
    """
    because i want bigger font"""
    node.img_style["hz_line_width"] = 2
    node.img_style["vt_line_width"] = 2
    node.img_style["size"]=2
    node.img_style["shape"] = "square"
    node.img_style["fgcolor"] = 'black'
    if node.is_root():
        node.img_style["size"]=0
        node.img_style["hz_line_color"]='white'
    if node.is_leaf():
        node.img_style["size"]=1
        node.img_style["shape"] = "circle"
        faces.add_face_to_node(faces.AttrFace("name","Courier", 13.5,
                                              'black', None),
                               node, 0, aligned=False)
        


###################### LOAD DATA ###################################
## table = """
## #Species	Protein coding	Intronic	SINE	LINE	LTR	DNA transposon	Satellite	Small RNA	Simple repeat	Low complexity	Unclassified repeat	Miscellaneous unique	Total
## Canis familiaris	26556087	502984812	243251071.0	461321498.0	107148389.0	59867636.0	595668.0	3429628.0	25808328.0	17513633.0	1256194.0	995377239.0	2445110183.0
## Rattus norvegicus	39144981	642980951	171456178.0	526328158.0	240357739.0	25517898.0	3548588.0	5324859.0	55040729.0	16623671.0	47824283.0	944732986.0	2718881021.0
## Danio rerio	51106830	548088528	31911777.0	36984466.0	67900098.0	473157323.0	28101508.0	2751619.0	41852231.0	21535007.0	12475619.0	41170041.0	1357035047.0
## Macaca mulatta	34248763	728142007	360914539.0	548219928.0	232295155.0	87968737.0	13254119.0	1308662.0	22275996.0	15702630.0	1446581.0	817888068.0	2863665185.0
## Zea mays	53757639	66964657	327593.0	17400689.0	1489307057.0	77376548.0	4316900.0	2790630.0	3055605.0	4039077.0	9841018.0	329405140.0	2058582553.0
## Monodelphis domestica	23206153	710238642	401973176.0	1008143972.0	326429056.0	60881930.0	6532.0	4065380.0	47788651.0	27718516.0	521305.0	891399725.0	3502373038.0
## Sorghum bicolor	42969423	48281252	9088.0	4940006.0	84680433.0	19145019.0	57388.0	68967.0	2677604.0	4371416.0	773589.0	451255182.0	659229367.0
## Tribolium castaneum	20173463	59717083	8383.0	211415.0	117226.0	2860130.0	0.0	516.0	336622.0	2950833.0	0.0	70281642.0	156657313.0
## Thalassiosira pseudonana	17395480	2171163	0.0	19582.0	339001.0	142872.0	18533.0	5074.0	84620.0	13972.0	13446.0	11098039.0	31301782.0
## Plasmodium falciparum	12234829	1405457	0.0	0.0	0.0	0.0	231059.0	35123.0	3813259.0	4883215.0	130939.0	530457.0	23264338.0
## Drosophila melanogaster	31755074	54452454	0.0	1893670.0	4596711.0	733485.0	311520.0	13624.0	1390902.0	1278435.0	769910.0	23185761.0	120381546.0
## Dictyostelium discoideum	12234599	1295539	0.0	838633.0	197893.0	84451.0	0.0	998.0	4486330.0	5749776.0	43.0	9054810.0	33943072.0
## Homo sapiens	103330430	1325743747	385270856.0	609952196.0	259122242.0	95646896.0	12381861.0	1443809.0	25937716.0	17947554.0	5418573.0	253481532.0	3095677412.0
## Pongo abelii	31944283	760025037	354298919.0	586537760.0	241594710.0	91819022.0	7795905.0	1358855.0	21535005.0	16693570.0	4141074.0	911746889.0	3029491029.0
## Equus caballus	27727539	606953510	172749025.0	532354848.0	162901077.0	75934365.0	1044029.0	84919978.0	9851737.0	10794806.0	1867645.0	679954888.0	2367053447.0
## Caenorhabditis elegans	28697958	33302888	87172.0	396882.0	399083.0	6845259.0	800017.0	7936.0	572486.0	1627503.0	2477999.0	25057093.0	100272276.0
## Bos taurus	36938825	675699344	423044126.0	544718934.0	110932903.0	50194885.0	995624.0	727223.0	12817390.0	12497823.0	952965.0	764893282.0	2634413324.0
## Mus musculus	77678111	912453947	194323459.0	512121108.0	297112207.0	27528140.0	3314029.0	1597592.0	55694579.0	19729301.0	8510525.0	544832220.0	2654895218.0
## Gallus gallus	24566419	325922087	655264.0	61258040.0	11127361.0	8460297.0	215604.0	224101.0	5278019.0	5478741.0	416095.0	588280415.0	1031882443.0
## Pan troglodytes	44770589	878543240	352119302.0	533798830.0	227050774.0	88453616.0	8625270.0	1313626.0	21414870.0	15848659.0	4303678.0	820025664.0	2996268118.0
## Tetraodon nigroviridis	23351380	70519625	85839.0	387004.0	0.0	0.0	243.0	35627.0	3657582.0	1297249.0	62.0	141649859.0	240984470.0
## Oryzias latipes	25089821	175964505	1823517.0	624218.0	132755.0	7311621.0	0.0	168288.0	3345687.0	4644059.0	862736.0	504251646.0	724218853.0
## Brachypodium distachyon	41675378	53395453	0.0	0.0	43397925.0	342455.0	2154.0	172340.0	903071.0	1135183.0	76.0	130124390.0	271148425.0
## Populus trichocarpa	45484336	41978324	1479778.0	946453.0	50680903.0	15771219.0	265497.0	1617021.0	2354975.0	18676878.0	9030296.0	190260215.0	378545895.0
## Arabidopsis lyrata	38760393	29155972	489705.0	3503282.0	14961954.0	7188652.0	515210.0	298680.0	824259.0	3555824.0	3441746.0	91486634.0	194182311.0
## Oryza sativa	41289044	35480684	1137265.0	2474501.0	59594982.0	40849179.0	264239.0	242307.0	1994055.0	1701378.0	2744620.0	105400674.0	293172928.0
## Arabidopsis thaliana	41144915	18537136	113434.0	1186326.0	7885813.0	5188644.0	1022137.0	60201.0	397721.0	1447609.0	2175285.0	39987127.0	119146348.0
## Taeniopygia guttata	15909562	242095477	812258.0	30965112.0	27359609.0	474414.0	15612.0	193221.0	5237961.0	7230743.0	365230.0	689794219.0	1020453418.0
## Anopheles gambiae	20644091	49248983	1553186.0	5294400.0	4622715.0	7544355.0	416997.0	9812.0	2457431.0	1278785.0	224768.0	137171134.0	230466657.0
## Saccharomyces cerevisiae	8758716	111552	0.0	0.0	399606.0	0.0	0.0	12034.0	65804.0	51268.0	50994.0	2620924.0	12070898.0
## Ciona intestinalis	13603923	30177268	3843839.0	1347787.0	55779.0	6478041.0	412792.0	5061.0	241484.0	1240042.0	53.0	36403884.0	93809953.0
## """

species = {'Gallus gallus'           : 'Birds',                 
           'Taeniopygia guttata'     : 'Birds',                 
           'Danio rerio'             : 'Fishes',                
           'Oryzias latipes'         : 'Fishes',                
           'Tetraodon nigroviridis'  : 'Fishes',                
           'Saccharomyces cerevisiae': 'Fungi',                 
           'Anopheles gambiae'       : 'Invertebrates',         
           'Caenorhabditis elegans'  : 'Invertebrates',         
           'Drosophila melanogaster' : 'Invertebrates',         
           'Tribolium castaneum'     : 'Invertebrates',         
           'Bos taurus'              : 'Mammals',               
           'Canis familiaris'        : 'Mammals',               
           'Equus caballus'          : 'Mammals',               
           'Homo sapiens'            : 'Mammals',               
           'Macaca mulatta'          : 'Mammals',               
           'Monodelphis domestica'   : 'Mammals',               
           'Mus musculus'            : 'Mammals',               
           'Pan troglodytes'         : 'Mammals',               
           'Pongo abelii'            : 'Mammals',               
           'Rattus norvegicus'       : 'Mammals',               
           'Arabidopsis lyrata'      : 'Plants',                
           'Arabidopsis thaliana'    : 'Plants',                
           'Brachypodium distachyon' : 'Plants',                
           'Oryza sativa'            : 'Plants',                
           'Populus trichocarpa'     : 'Plants',                
           'Sorghum bicolor'         : 'Plants',                
           'Zea mays'                : 'Plants',                
           'Dictyostelium discoideum': 'unicellular Eukaryotes',
           'Plasmodium falciparum'   : 'unicellular Eukaryotes',
           'Thalassiosira pseudonana': 'unicellular Eukaryotes',
           'Ciona intestinalis'      : 'Urochordate'}           

elements = {}
for line in open('prop_ge/all_GS.tbl'):
#for line in table.split('\n'):
    if not line: continue
    if line.startswith('#'):
        keys = line[1:].strip().split('\t')
    else:
        elts = dict(zip(keys, line.strip().split('\t')))
        spe = elts['Species']
        total = float(elts['Total'])
        del(elts['Species'])
        elements[spe] = {}
        for k in elts:
            elements[spe][k] = float(elts[k])/total*100

keys = keys[1:-1]
####################################################################


###################### LOAD TREE ###################################
tree= Tree('((((Arabidopsis thaliana:0.0898463,Arabidopsis lyrata:0.0995407)NoName:0.234677,Populus trichocarpa:0.31316)NoName:0.0821533,((Brachypodium distachyon:0.203841,Oryza sativa:0.295291)NoName:0.0230444,(Zea mays:0.204318,Sorghum bicolor:0.0918347)NoName:0.088112)NoName:0.203712)NoName:0.825127,((((((Danio rerio:0.253567,(Oryzias latipes:0.163666,Tetraodon nigroviridis:0.274028)NoName:0.0657831)NoName:0.120356,((Taeniopygia guttata:0.0838698,Gallus gallus:0.0669647)NoName:0.146994,(Monodelphis domestica:0.157621,((((Pongo abelii:0.106124,(Homo sapiens:0.00813613,Pan troglodytes:0.0483462)NoName:0.00627258)NoName:0.00754995,Macaca mulatta:0.0577307)NoName:0.0365404,(Mus musculus:0.0266035,Rattus norvegicus:0.0750942)NoName:0.0873059)NoName:0.00917864,((Equus caballus:0.0589069,Bos taurus:0.11609)NoName:0.00472376,Canis familiaris:0.0867083)NoName:0.0182315)NoName:0.0920961)NoName:0.0554755)NoName:0.122906)NoName:0.237299,Ciona intestinalis:0.711065)NoName:0.086661,(Caenorhabditis elegans:1.03832,(Tribolium castaneum:0.458641,(Anopheles gambiae:0.40814,Drosophila melanogaster:0.552737)NoName:0.195372)NoName:0.328332)NoName:0.0643657)NoName:0.413833,Saccharomyces cerevisiae:1.69716)NoName:0.111912,Dictyostelium discoideum:1.08758)NoName:0.0959179,(Thalassiosira pseudonana:0.988429,Plasmodium falciparum:2.03194)NoName:0.15):0;', format=1)

# stupid formating of the tree ####################################
def shorten(name):
    return ' ' + name.split()[0][0] + '. ' + name.split()[1] + ' '

names = dict([(shorten(l.name), l.name) for l in tree])
for l in tree:
    l.name = shorten(l.name)
for n in tree.iter_descendants():
    n.dist=n.dist
tree= Tree(tree.write(format=1).replace(';', ':.001;'), format=1)
for l in tree:
    l.name = ' ' + l.name + ' '
###################################################################

colors = ['red', 'darkred', 'darkgreen', 'darkolivegreen', '#829822',#'darkkhaki',
          'midnightblue', 'purple', 'chocolate', 'darkorange', 'gold',
          'gray', 'lightgray']

ts = TreeStyle()
ts.mode='c'
ts.arc_span = 360
ts.show_leaf_name = False
ts.legend = {'why a dict of lists??': [Legend(colors, keys,fsize=14,columns=4)]}
ts.legend_position=3
ts.min_leaf_separation = 0
ts.root_opening_factor = 0.04
ts.draw_aligned_faces_as_table=True
for leaf in tree:
    leaf.add_face(faces.PieChartFace([elements[names[leaf.name]][e] for e in keys],
                                     73,73,colors), 1, position='aligned')
    leaf.name = shorten(leaf.name)

clade_col = {' M. domestica '   : ['#ffe9ce','#ffe9b9','#ffe9b9'],
             ' C. intestinalis ': ['#f6e6c5'],
             ' C. elegans '     : ['#fffecf'],
             #'C. elegans'     : ['#fcff9c'],
             #'S. cerevisiae'  : ['#fde8fb','#fde8fb'],
             ' S. cerevisiae '  : ['#f0e8ff','#f0e8ff'],
             #'D. discoideum'  : ['#e2fdfc'],
             #'P. falciparum'  : ['#f0e8ff'],
             ' P. falciparum '  : ['#e2fdfc'],
             ' P. trichocarpa ' : ['#e8ffe0','#e8ffe0']}


for leaf in tree:
    if not leaf.name in clade_col:
        continue
    node=leaf
    for col in clade_col[leaf.name]:
        node = node.up
        node.img_style = NodeStyle ()
        node.img_style ['bgcolor'] = col

#tree.show(tree_style=ts, layout=my_basic)

tree.render('../figures/untb_genomes/prop_genetic_species.pdf', tree_style=ts, w=4000, layout=my_basic)



